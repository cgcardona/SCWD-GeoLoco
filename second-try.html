<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>SCWD GeoLoco()</title>
        <style>
        
        </style>
    </head>
    <body>
        <div id="container">
            <p id="">Latitude:</p>
            <p id="lat"></p>
            <p id="">Longitude</p>
            <p id="lon"></p>
            <p id="pairs"></p>
        </div><!--end of container div-->
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script>
          $(document).ready(function() {
            // call the getGeo() method
            getGeo()
          })
        </script>
        <script>
            // getGeo function
            function getGeo() {
              navigator.geolocation.watchPosition(function(position,
              handle_error, enableHighAccuracy) {

                  // assign lat and lon to vars
                  var latitude = position.coords.latitude
                  var longitude = position.coords.longitude

                  // print lat and on to page
                  $("#lat").html(latitude)
                  $("#lon").html(longitude)

                  // call doSetItem() method
                  doSetItem()
              }) // end of watchPosition
            } // end of getGeo 

            // doSetItem function
            function doSetItem() {
              // grab the lat and lon from the page and assign to vars
              var storageLatitude = $("#lat").text()
              var storageLongitude = $("#lon").text()
              
              // grab the date and store it in a var
              var dateStamp = new Date()

              // create JSON for local storage
              var storageObject = {"Latitude:": storageLatitude, "Longitude:": storageLongitude}

              // stringify JSON
              var stringObject = JSON.stringify(storageObject)

              //store locally with HTML5 localStorage API
              localStorage.setItem(dateStamp, stringObject)

              // call doGetItem() method
              doGetItem()

            } // end of doSetItem()

            // doSetItem function
            function doSetItem() {
              var keys = ""
              var pairs = "<tr><th>Date</th><th>Location</th></tr>\n"
              var i = 0
              for(i=0; i<=localStorage.length-1; i++) {
                key = localStorage.key(i)
                pairs +=
                "<tr><td>"+key+"</td>\n<td>"+localStorage.getItem(key)+"</td></tr>\n"
            } // for()
            // write pairs to screen
            $("#pairs").html(pairs)
            } // end of doSetItem()
        </script>
    </body>
</html>
