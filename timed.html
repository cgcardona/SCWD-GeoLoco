<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>SCWD Geo Loco</title>
  <style>
    *{
      margin:0;
      padding:0;
    }

    #container{
      padding:20px;
      width:800px;
      margin:40px auto 0;
      color:white;
      background-color:#6C8CD5;
      border-radius:5px;
      -webkit-box-shadow:#000 1px 1px 20px;
      text-shadow:#000 1px 1px 1px;
    }
  </style>
</head>
<body>
  <div id="container">
    <p id="">Latitude:</p>
    <p id="lat"></p>
    <p id="">Longitude:</p>
    <p id="lon"></p>
    <p id="pairs"></p>
  </div><!--end of container div-->
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script>
  $(document).ready(function(){
    getGeo()
  });
  </script>
  <script>
  // get the users lon and lat with html5 geolocation api
  function getGeo() {
    navigator.geolocation.watchPosition(function(position, handle_error, enableHighAccuracy) {
      // assign lat and lon to vars
      var latitude = position.coords.latitude
      var longitude = position.coords.longitude

      // print to the page
      $('#lat').html(latitude)
      $('#lon').html(longitude)

      // call the doSetItem() method
      doSetItem()
    }) // end of watchPosition
  } // end of getGeo()

  function doSetItem() {
    // grab lat and lon from screen and assign to storage vars
    var storageLatitude = $("#lat").text()
    var storageLongitude = $("#lon").text()
    var dateStamp = new Date()
    var storageObject = {"Latitude:": storageLatitude, "Longitude:": storageLongitude}
    var stringyObject = JSON.stringify(storageObject)

    // store locally with html5 local storage api
    localStorage.setItem(dateStamp, stringyObject)

    // call doGetItem()
    doGetItem()
  } // end of doSetItem()

  function doGetItem() {
    var key = "";
    var pairs = "<tr><th>Date</th><th>Location</th></tr>\n";
    var i=0;
    for (i=0; i<=localStorage.length-1; i++) {
      key = localStorage.key(i);
      pairs += "<tr><td>"+key+"</td>\n<td>"+localStorage.getItem(key)+"</td></tr>\n";
     }  // for
     $('#pairs').html(pairs)
  } // end of doGetItem()
  </script>
</body>
</html>